# FruitShop 商品削除の実装

ウェブアプリケーションで商品を削除する際、以下のような手順で処理されます。

1. **コントローラーの作成**  
 商品を削除するための `destroy` アクションを実装します。

1. **ビューの作成**  
 商品削除ボタンを表示するためのビューを作成します。

1. **ルーティングの設定**  
 商品削除機能へのルーティングを設定します。

このように、商品削除機能には「データベースの準備」「モデルの作成」「コントローラーの作成」「ビューの作成」「ルーティングの設定」のステップが含まれます。  
それでは、各ステップを実装するための流れを詳しく見ていきましょう。

## 実装の流れ

ウェブアプリで商品を削除するためには、以下の手順で実装を進めます。

### 1. コントローラーの作成

商品を削除する `ProductsController` を作成します。

```ruby
# app/controllers/products_controller.rb
class ProductsController < ApplicationController
  # 商品を削除するアクション
  def destroy
    @product = Product.find(params[:id])
    @product.destroy
    redirect_to products_path # 商品一覧にリダイレクト
  end
end
```

<details>
<summary>現在の商品コントローラー</summary>

```ruby
class ProductsController < ApplicationController
  def new
    @product = Product.new
  end

  def create
    @product = Product.new(product_params)
    if @product.save
      redirect_to root_path
    else
      render :new
    end
  end

  def index
    @products = Product.all
  end

  def show
    @product = Product.find(params[:id])
  end

  def edit
    @product = Product.find(params[:id])
  end

  def update
    @product = Product.find(params[:id])
    if @product.update(product_params)
      redirect_to products_path
    else
      render :edit
    end
  end

  def destroy
    @product = Product.find(params[:id])
    @product.destroy
    redirect_to products_path
  end

  private

  def product_params
    params.require(:product).permit(:name, :description, :price)
  end
end
```

</details>

### 2. ビューの作成

商品削除ボタンを表示するためのビューを作成します。

```erb
<!-- app/views/products/show.html.erb -->
<%= link_to '削除', product_path(@product), method: :delete, data: { confirm: '本当に削除しますか？' } %>
```

上記コードの `data: { confirm: '本当に削除しますか？' }` の部分が、削除確認ダイアログを表示する役割を持ちます。
この記述により、ユーザーが削除ボタンをクリックした際に、ブラウザのポップアップが表示され、「本当に削除しますか？」と確認を求めるようになります。


> **メモ：削除確認ダイアログ**  
> **削除確認ダイアログ**とは、**ユーザーが削除操作を行う前に確認を求めるポップアップメッセージ**です。  
> 削除確認ダイアログには、主に以下の役割があります。  
>  
> * **誤操作の防止**  
>  ユーザーが誤って重要なデータを削除しないように、確認を求めることで誤操作を防ぎます。  
>  
> * **ユーザーの意図確認**  
>  本当に削除する意思があるかをユーザーに確認し、意図的な操作であることを確かめます。  
>  
> * **データ保護**  
>  誤ってデータが失われることを防ぎ、データの保護に寄与します。 

### 3. ルーティングの設定

商品削除機能へのルーティングを設定します。

```diff
+ delete 'products/:id' => 'products#destroy'
```

```ruby
# app/config/routes.rb
Rails.application.routes.draw do
  get 'products/new'  # 商品投稿フォームを表示
  post 'products' => 'products#create'  # 商品を保存する
  get 'products' => 'products#index'  # 商品一覧を表示する
  get 'products/:id' => 'products#show', as: 'product'  # 商品詳細を表示する
  get 'products/:id/edit' => 'products#edit', as: 'edit_product'  # 商品編集フォームを表示
  patch 'products/:id' => 'products#update'  # 商品を更新する
  delete 'products/:id' => 'products#destroy'  # 商品を削除する
end
```

### まとめ

- `ProductsController` の `destroy` アクションの実装
- 商品削除ボタンを表示するビューの作成
- ルーティングの設定

これにより、FruitShop の商品削除機能を適切に実装できるようになります。