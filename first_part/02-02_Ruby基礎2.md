# 2 Ruby基礎

## 目次

- [(6) 演算子](#6-演算子)
- [(7) 条件分岐](#7-条件分岐)
- [(8) 繰り返し](#8-繰り返し)
  - [（8.5）インクリメント](#85-インクリメント値を1増やす)
- [(9) メソッド](#9-メソッド)
- [【問題】](#問題)

--- 

###	(6) __演算子__  
###	(6)-1 演算子とは？ 
Rubyでは、演算子（`+` や `-` など）は特別な「キーワード」のように見えますが、実はすべて「 __メソッド__ 」として扱われています。  
そのため、ほとんどの演算子を自分で作り変えること（再定義）が可能です。  

ただし、Rubyが用意していない演算子を使おうとするとエラーが発生しますので注意してください。

---

###	(6)-2 演算子の優先順位
プログラムの中で複数の演算子を使うとき、それぞれの計算をどの順番で行うかは「 __優先順位__ 」によって決まります。  
この優先順位を知らないと、プログラムが自分の意図と違う動きをしてしまうことがあります。  

例えば以下のように、`*` や `/` は `+` よりも優先して計算されます。

---

#### 演算子の優先順位（高い順）
| 優先順位 | 演算子 | 説明 | 例 |
|---------:|--------|------|----|
| 1 | `::` | 定数やクラスの参照 | `Math::PI` |
| 2 | `[]` | 配列・ハッシュの要素参照 | `array[0]` |
| 3 | `+`(単項), `!`, `~` | 正の値、論理否定、ビット反転 | `+a`, `!true`, `~0b1010` |
| 4 | `**` | べき乗 | `2**3`（2の3乗） |
| 5 | `-`(単項) | 負の値 | `-10` |
| 6 | `*`, `/`, `%` | 掛け算、割り算、余り | `10 * 2`, `10 / 3`, `10 % 3` |
| 7 | `+`, `-` | 足し算、引き算 | `5 + 3`, `5 - 3` |
| 8 | `<<`, `>>` | ビットシフト | `2 << 1` |
| 9 | `&` | ビットAND | `5 & 3` |
| 10 | **&#x7C;** , `^` | ビットOR、XOR | **5 &#x7C; 3** , `5 ^ 3` |
| 11 | `>`, `>=`, `<`, `<=` | 大小比較 | `5 > 3`（true） |
| 12 | `<=>`, `==`, `===`, `!=`, `=~`, `!~` | 比較・正規表現マッチ | `"abc" =~ /a/` |
| 13 | `&&` | 論理AND | `true && false` |
| 14 | **&#x7C;&#x7C;** | 論理OR | **true &#x7C;&#x7C; false** |
| 15 | `..`, `...` | 範囲 | `(1..5)`, `(1...5)` |
| 16 | `?:` | 条件演算子 | `条件 ? 真 : 偽` |
| 17 | `=`, `+=`, `-=`, `*=`, `/=` | 代入 | `x = 5`, `x += 3` |
| 18 | `not` | 否定（`!` と同じ） | `not true`（false） |
| 19 | `and`, `or` | 条件の結合 | `true and false`（false） |

---

__優先順位の例__  
具体例を見てみましょう。  

```rb
a && b || c
```

1. `&&` は `||` よりも優先順位が高いため、まず `(a && b)` が計算されます。  
2. 次に `(a && b) || c` が計算されます。  

もう一つの例です。

```rb
a || b && c
```

1. `&&` は `||` よりも優先順位が高いため、まず `(b && c)` が計算されます。  
2. 次に `a || (b && c)` が計算されます。

---

#### ポイント

+ __演算子の優先順位は、数学のルールに似ています。__  
  例えば、掛け算（`*`）は足し算（`+`）よりも先に計算されるのと同じです。

+ __必要に応じてカッコを使うと優先順位を明確にできます。__  
  例えば、`a || (b && c)` のように書くと、計算の順番がはっきりして間違いにくくなります。

<br>

--- 

### (7) __条件分岐__  
プログラムで「条件に応じて違う処理をする」ために使います。  

<img src="images/Ruby基礎/条件分岐解説図1.png" width= "600px">

###	(7)-1　if（もし〜なら）  
#### ①　基本の使い方

条件が __真（true）__ なら処理を実行します。

```rb
num = 10

if num == 10
  puts "OK"  # numが10ならこの行が実行される
end
```

#### ② if文の条件に満たない場合

`else` を使うと、条件が __偽（false）__ の場合の処理も書けます。

```rb
num = 100

if num < 10
  puts "OK"  # numが10未満ならこの行が実行される
else
  puts "NG"  # それ以外ならこの行が実行される
end
```

#### ③ 複数の条件がある場合  

`elsif` を使うと、条件をさらに増やせます。

```rb
num = 1

if num < 0
  puts "negative"  # numが0未満ならこの行
elsif num == 1
  puts "one"       # numが1ならこの行
else
  puts num         # その他の場合はnumをそのまま表示
end
```

#### ④ 後置if（簡単な条件で使う）  

処理を短く書けます。  

```rb
puts "OK" if true  # 条件がtrueなら"OK"を表示
```

#### ⑤ 三項演算子 

`?:`を使うことで、短く条件分岐を書けます。

```rb
num = 5
result = num > 0 ? "positive" : "negative"
puts result  # numが0より大きければ"positive"、それ以外は"negative"
```

---

### (7)-2 unless（〜でない場合）
`if` の逆で、条件が __偽（false）__ のときに処理を実行します。
```rb
unless false
  puts "OK"  # 条件がfalseならこの行
else
  puts "NG"  # 条件がtrueならこの行
end
```

---

### (7)-3 case（たくさんの条件がある場合）
複数の条件をシンプルに書くのに便利です。他の言語の `switch` に似ています。  

```rb
num = 1

case num
when 0
  puts "zero"       # numが0ならこの行
when 1
  puts "one"        # numが1ならこの行
when 2, 3, 5, 7
  puts "prime"      # numが2, 3, 5, 7のいずれかならこの行
when 100..1000
  puts "over 100"   # numが100〜1000ならこの行
else
  puts "unknown"    # その他の場合
end
```

---

#### ポイント

+ __`if` と `unless` の違い__  
  if は「〜なら」、unless は「〜でなければ」を表します。
+ __後置ifと三項演算子__  
  短い条件分岐に便利。コードがスッキリします。
+ __`case`__  
  複数条件がある場合に便利。

<br>

--- 

###	(8) __繰り返し__  

プログラムで同じ処理を何度も繰り返したいときに使います。
Rubyには便利な繰り返しの仕組みがたくさんあります。  

<img src="images/Ruby基礎/条件分岐解説図2.png" width= "600px">

###	(8)-1 while（〜の間繰り返す）  

#### ① 基本の使い方  

条件が`true`の間、処理を繰り返します。

```rb
arr = []

# 配列のサイズが3未満の間、"hoge"を追加する
while arr.size < 3
  arr << "hoge"
end

p arr  #=> ["hoge", "hoge", "hoge"]
```

#### ② 短く書く（後置while）  

`while` を後ろに置くことで、簡潔に書けます。  

```rb
arr = []

# 配列のサイズが3未満の間、"hoge"を追加する
arr << "hoge" while arr.size < 3

p arr  #=> ["hoge", "hoge", "hoge"]
```

---

###	(8)-2 times（指定回数繰り返す）  

指定した回数だけ繰り返し処理を行います。  

```rb
# 5回繰り返して "OK" を表示する
5.times do
  puts "OK"
end

# 実行結果:
# OK
# OK
# OK
# OK
# OK
```

---

###	(8)-3 each（データの中身を順番に取り出す）  
配列やデータの要素を一つずつ取り出して処理します。  

```rb
numbers = [1, 2, 3, 4, 5]

# 配列の要素を一つずつ取り出して表示する
numbers.each do |num|
  puts num
end

# 実行結果:
# 1
# 2
# 3
# 4
# 5
```

---

###	(8)-4 for（指定した範囲で繰り返す）  
`for` を使うと、指定した範囲や配列の要素を順番に繰り返すことができます。  

```rb
# 1から5まで繰り返す
for i in 1..5
  puts i
end

# 実行結果:
# 1
# 2
# 3
# 4
# 5
```

`for` は範囲（`1..5`）の中で繰り返す処理を簡単に書ける方法です。

---

### (8)-5 until（〜でない限り繰り返す）  
`until` は条件が __false__ である限り処理を繰り返します。つまり、「条件が __true__ になったら止まる」という形になります。  

```rb
# 配列のサイズが3以上になるまで繰り返す
arr = []

until arr.size >= 3
  arr << "hoge"
end

p arr  #=> ["hoge", "hoge", "hoge"]
```

---

### (8)-6 upto（指定した数まで繰り返す）   
`upto` は指定した数まで順番に繰り返します。指定した数を含めて繰り返すのが特徴です。  

```rb
# 1から5まで繰り返す（5も含まれる）
1.upto(5) do |i|
  puts i
end

# 実行結果:
# 1
# 2
# 3
# 4
# 5
```

---

### (8.5) インクリメント（値を1増やす）  
繰り返し処理では、変数を少しずつ増やしたり（インクリメント）することがよくあります。  

1. __`+=` を使う__  
変数に特定の値を加えます。
    ```rb
    x = 5
    x += 1  # xに1を足す
    puts x  # 出力: 6
    ```

2. __`succ` メソッドを使う__  
`succ` は次の値を返すメソッドです（数値や文字に使えます）。  
    ```rb
    # 数値を増やす
    x = 5
    x = x.succ
    puts x  # 出力: 6

    # 文字を次に進める
    str = "a"
    str = str.succ
    puts str  # 出力: "b"
    ```

---

#### ポイント
1. `while`__（条件が`true`の間繰り返す）__  
    + 条件が `true` の間、処理を繰り返す。
    + 後置`while`で簡潔に書ける。
2. `times`__（指定回数繰り返す）__  
    + 指定した回数だけ繰り返し処理を実行。
3. `each`__（データの要素を一つずつ取り出す）__  
    + 配列などのデータを順番に取り出して処理。
4. `for`__（範囲や配列の要素を繰り返す）__  
    + 範囲（`1..5`）などで指定された値を順番に繰り返し。
5. `until`__（条件がfalseである限り繰り返す）__  
    + 条件が`true`になるまで繰り返し処理を実行。
6. `upto`__（指定した数まで繰り返す）__  
    + 指定した数まで順番に繰り返し（指定した数も含む）。
7. __インクリメント（値を1増やす）__  
    + `+=`演算子や`succ`メソッドを使って、変数の値を増やす。

<br>

--- 

###	(9) __メソッド__  
プログラムの中で、繰り返し使う処理をまとめておくために「__メソッド__」を使います。これを使うことで、コードを整理し、再利用することができます。  
例えるならば、クラスは「料理のレシピ」、オブジェクトは「実際に作られた料理」です。メソッドはレシピに書かれた「料理の手順」で、手順通りに作ることで料理が完成します。クラスを使ってオブジェクトを作り、メソッドで動作を実行します。  

<img src="images/Ruby基礎/メソッド解説図1.png" width= "600px">

###	(9)-1　メソッドについて    
メソッドを使うとき、どのオブジェクトに対してそのメソッドを実行するかを「__レシーバ__」と言います。  
Rubyのメソッドは「レシーバ」によって3つの種類に分けることができます。
#### ① __インスタンスメソッド__  
+ __インスタンス__ を使ってメソッドを呼び出します。  
+ クラスから作ったオブジェクト（インスタンス）に対してメソッドを実行します。  
#### ② __クラスメソッド__  
+ __クラス__ そのものに対してメソッドを呼び出します。  
+ クラス自体を使ってメソッドを実行します。  
#### ③ __プライベートメソッド__  
+ 他の場所からは呼び出せません。  
+ クラス内の処理でのみ使うためのメソッドです。  

例えば、次の例では`numbers`がレシーバです。

```rb
numbers.each do |num|
  puts num
end
```

##### 用語解説
+ __クラス__: 関連するデータ（属性）と処理（メソッド）をひとまとめにする仕組み。  
+ __インスタンス__: インスタンスは、クラスから実際に生成されたオブジェクトのこと。  

詳しくはそれぞれの項目で解説します。

---

#### 引数と戻り値  

メソッドには「引数」と「戻り値」という概念があります。  
+ __引数__  
  メソッドに渡す情報です。メソッドを使うときに必要なデータを渡すことで、そのデータを使ってメソッドが処理をします。
+ __戻り値__  
  メソッドを実行した後に返ってくる結果です。  

例えば、次のメソッドでは、2つの数字を受け取って足してその結果を`return`を使って返します。  

```rb
def add(x, y)
  return x + y
end

result = add(3, 5)  # 3と5を足して、結果8が返ってくる
puts result  #=> 8
```

戻り値を返さないメソッドもあります。この場合、デフォルトで`nil`が返されます。  

```rb
def say_hello
  puts "Hello, World!"
end

result = say_hello
puts result  #=> nil
```

また、`return`を使用するとそれ以降のメソッド内の処理は行われないため、注意が必要です。  

---

###	(9)-2 メソッドの定義方法  

#### ① __メソッドの共通の書き方__  
+ メソッド名は最初を小文字にし、複数の単語がある場合は`_`でつなげます（スネークケース）。  
+ メソッドを定義するには、`def`（定義の開始）と`end`（定義の終了）で囲みます。  

  ```rb
  def to_answer(answer)
    puts "答えは#{answer}です"
  end

  to_answer(8)  #=> 答えは8です
  ```

#### ② __インスタンスメソッド__  
+ クラス内で定義したメソッドで、インスタンスを使って実行します。

  ```rb
  class Sample
    def to_answer(answer)
      puts "答えは#{answer}です"
    end
  end

  sample = Sample.new
  sample.to_answer(8)  #=> 答えは8です
  ```

#### ③ クラスメソッド  
+ クラス自体を使って実行するメソッドです。  
+ `class`内で定義するか、`class名.method名`で定義します。

  ```rb
  class Sample
  end

  def Sample.to_answer(answer)
    puts "答えは#{answer}です"
  end

  Sample.to_answer(8)  #=> 答えは8です
  ```

  クラス定義内でも`self`を使ってクラスメソッドを定義できます。  

  ```rb
  class Sample
    def self.to_answer(answer)
      puts "答えは#{answer}です"
    end
  end

  Sample.to_answer(8)  #=> 答えは8です
  ```

####	④　プライベートメソッド  
+ クラス内でしか使えないメソッドです。
+ 外部からは呼び出せません。内部処理用のメソッドとして使います。
+ `private`を使うことで、それ以降のメソッドはプライベートメソッドとして扱われます。  

  ```rb
  class Sample
    private

    def to_answer(answer)
      puts "答えは#{answer}です"
    end
  end

  sample = Sample.new
  sample.to_answer(8)  #=> これはエラーになる
  ```
  ---

#### ポイント
1. __メソッドとは？__  
    + 繰り返し使う処理をまとめたもの。  
    + コードを整理し、再利用できるようにする仕組み。  

2. __メソッドの種類（Rubyの「レシーバ」による分類）__  
    1. __インスタンスメソッド__
        + インスタンス（クラスから作られたオブジェクト）を使って呼び出すメソッド。
    2. __クラスメソッド__
        + クラスそのものに対して呼び出すメソッド。
    3. __プライベートメソッド__
        + クラス内部でのみ使えるメソッド。外部から呼び出すことはできない。

3. __引数と戻り値__
    + __引数__：メソッドに渡す情報。処理に必要なデータを提供する。
    + __戻り値__：メソッドが実行後に返す結果。計算結果や処理結果など。

4. __メソッドの書き方__
    1. __基本の書き方__
        + メソッド名はスネークケース（単語をアンダースコアで区切る形式）で書く。
        + 定義は「開始」と「終了」を明確に記述する。
    2. __インスタンスメソッド__
        + クラス内で定義し、インスタンスを使って実行する。
    3. __クラスメソッド__
        + クラス自体で実行するためのメソッド。
        + クラス内で定義するか、クラス名を使って直接定義する方法がある。
    4. __プライベートメソッド__
        + 外部からは呼び出せず、クラス内部専用。
        + 定義時に「プライベートであること」を明示する。

5. __メソッドを使うメリット__
    + コードを簡潔でわかりやすくする。  
    + 同じ処理を繰り返し記述する必要がなくなる。
    + 処理をまとめて管理できるため、バグを防ぎやすい。
    + 再利用性が高まり、開発効率が向上する。

<br>

--- 

### __【問題】__  
1. 与えられた2つの整数`a`と`b`の和を計算するコードを作成してください。  
	<details>
	<summary>解答例</summary>
	
	```rb
	a = 5
	b = 10
	puts  a + b
	```

	</details>
2. 与えられた整数`num`が偶数であれば`true`、奇数であれば`false`を返すコードを作成してください。  
	<details>
	<summary>解答例</summary>
	
	```rb
	num = 8
	puts num % 2 == 0
	```

	</details>
3. 与えられた2つの文字列`str1`と`str2`を連結して返すコードを作成してください。ただし、`+`演算子を使用してはいけません。  
	<details>
	<summary>解答例</summary>
	
	```rb
	str1 = "abc"
	str2 = "dfg"
	puts str1 << str2
	```

	</details>
4. 与えられた2つの整数`a`と`b`で`a`が`b`より大きいときに`true`、そうでなければ`false`を返すコードを作成してください。  
	<details>
	<summary>解答例</summary>
	
	```rb
	a = 30
	b = 10
	puts a > b
	```

	</details>
5. 与えられた整数`num`が偶数か奇数かを判定し、偶数ならば`"Even"`、奇数ならば`"Odd"`を返すコードを作成してください。  
	<details>
	<summary>解答例</summary>

	```rb
	num = 10

	if num % 2 == 0
		puts "Even"
	else
		puts "Odd"
	end
	```

	</details>
6. 与えられた2つの整数`a`と`b`の大小を比較し、`a`が`b`より大きければ`"aはbより大きい"`、`b`が`a`より大きければ`"bはaより大きい"`、等しければ`"aとbは同じ"`を返すコードを作成してください。
	<details>
	<summary>解答例</summary>

	```rb
	a = 10
	b = 20

	if a > b
		puts "aはbより大きい"
	elsif b > a
		puts "bはaより大きい"
	else
		puts "aとbは同じ"
	end
	```

	</details>
7. 1から10までの整数を順番に出力するコードを作成してください。ただし、繰り返し処理には`while`を使用してください。
	<details>
	<summary>解答例</summary>

	```rb
	num = 1

	while num <= 10
		puts num
		num += 1
	end
	```

	</details>
8. 与えられた配列`arr`の要素を順番に出力するコードを作成してください。ただし、`arr`の中身は文字列、繰り返し処理には`each`を使用してください。
	<details>
	<summary>解答例</summary>

	```rb
	arr = ["apple", "orange", "banana"]

	arr.each do |elem|
		puts elem
	end
	```

	</details>
9. 2つの整数`a`と`b`の和を計算するメソッド`add`を作成してください。
	<details>
	<summary>解答例</summary>

	```rb
	def add(a, b)
		a + b
	end

	puts add(100, 200)
	```

	</details>
10. 与えられた配列`arr`の要素の平均を出力するメソッド`calculate_average`を作成してください。ただし、`arr`の中身は数値、メソッドは戻り値を返すようにしてください。
	<details>
	<summary>解答例</summary>

	```rb
	def calculate_average(arr)
		total = arr.sum
		average = total / arr.length
		return average
	end

	result = calculate_average([100, 200, 300, 400, 500])
	puts result
	```
	</details>

